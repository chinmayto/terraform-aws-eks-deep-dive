apiVersion: v1
kind: Pod
metadata:
  name: app-using-efs
  namespace: default
  labels:
    app: efs-test-app
spec:
  containers:
    - name: app
      image: amazonlinux:latest
      command: ["/bin/sh"]
      args: 
        - "-c"
        - |
          echo "Starting EFS test application..."
          echo "EFS mount point: /data"
          echo "Creating test file with timestamp..."
          while true; do 
            echo "$(date): EFS is working!" >> /data/out.txt
            echo "$(date): Writing to EFS..." 
            sleep 10
          done
      volumeMounts:
        - name: efs-storage
          mountPath: /data
      resources:
        requests:
          memory: "64Mi"
          cpu: "50m"
        limits:
          memory: "128Mi"
          cpu: "100m"
  volumes:
    - name: efs-storage
      persistentVolumeClaim:
        claimName: efs-claim
  restartPolicy: Always
